START:	
	IN 10H			
	LXI H,0A00H		; жоятымы стом HL тгм 1Г хесг тгс лмглгс 
	MVI M,10H		
	INX H			; деивмы стгм еполемг хесг 0A00H...0A05H
	MVI M,10H		
	INX H				
	MVI M,10H		 
	INX H			
	MVI M,10H

	MVI A,0DH		; 0DH = 00001101. жтиавмы тг ласйа поу епитяепеи тг диайопг
       SIM                 ; RST6.5 йаи апемеяцопоиеи тисдиайопес RST5.5 & 7.5	
	EI                

WAIT:				; пеяилемы циа диайопг
	JMP WAIT	


BCD:
	PUSH PSW             ; вягсилеуеи циа то пяыто патгла тоу диайоптг поу еимаи 
	PUSH B               ; амацйаиа г жуканг тым йатавыягтым йаи тоу PSW
	PUSH D
	PUSH H			
	MVI B,FFH 	       ; бафы сто б то FF(11111111)
	MOV A,E             
DECA:
	INR B 			; аунамы то B поу еимаи о летягтгс тым дейадым
 	SUI 0AH 		; ажаияы апо то A  10(дейадийо), леиымомтас етси йата лиа дейада том аяихло
	JNC DECA 		; сумевифы ма ажаияы ам г сглаиа CY дем еимаи лгдем 
				
	ADI 0AH 		; пяосхеты 10 циа ма диояхысы тг дейада поу ажаияеса пяим 
				; емы дем вяеиафотам
	LXI H,0A04H
	MOV M,A 		; апохгйеуы тис ломадес сто 5О ьгжио тоу LCD
				
	INX H		
	MOV M,B		; апохгйеуы тис ломадес сто 6О ьгжио тоу LCD

	LXI D,0A04H		; елжамифы то апотекесла ста 2 дениотеяа ьгжиа 
	CALL STDM		; йаи йакы тгм STDM
	
	LXI B,0032H		; BC = 50 ---> DELB 50 msec delay
	MVI A,14H		; A = 250 --> 50 msec X 20 = 1 sec delay
ONESECLOOP:
	CALL DCD		; ейтупымы
	CALL DELB		; йаи ежаялофы йахустеягсг
	DCR A               ; Mеиымы то а поу летяаеи тис 20 епамакгьеис
	CPI 00H             ; ам дем еимаи лгдем сумевифы
	JNZ ONESECLOOP		

	POP H 		       ; апойатастасг тым йатавыягтым
	POP D
	POP B
	POP PSW
	RET


INTR_ROUTINE:		      ; яоутима енупгяетгсгс диайопгс
	POP H		      ; йамы pop PC апо тг стоиба
	
       LXI B,0064H
	MVI A,FFH           ; апохгйеуы то 11111111 циа ма амаьоум ока та калпайиа
       CMA                 ; амтистяежы епеидг еимаи аямгтийгс коцийгс
	CALL DELB           ; йакы йахустеягсг
       CALL DELB
       CALL DELB
       CALL DELB
       CALL DELB
       STA 3000H	      ; елжамифы то апотекесла ста  калпайиа

       MVI A,00H           ; еды ейама аккацг циа ма амабосбгмеи 
	CMA  
       CALL DELB           ; йакы йахустеягсг
       CALL DELB
       CALL DELB
       CALL DELB
       CALL DELB                
 	STA 3000H	       

       

	MVI E,3CH	       
	EI                  ; ENABLE INTERRUPT
LOOP1:
       MVI A,FFH           ; апохгйеуы то 11111111 циа ма амаьоум ока та калпайиа
       CMA                 ; амтистяежы епеидг еимаи аямгтийгс коцийгс
	CALL DELB           ; ежаялофы йахустеягсг
       CALL DELB
       CALL DELB
       CALL DELB
       CALL DELB
       STA 3000H	      ; елжамифы то апотекесла ста  калпайиа

       MVI A,00H           ; сбгмы ока та калпайиа 
	CMA   
       CALL DELB           ; ежаялофы йахустеягсг           
       CALL DELB
       CALL DELB
       CALL DELB 
       CALL DELB               
 	STA 3000H	      ; елжамифы апотекесла
	CALL BCD	      ; йакы тгм BCD циа ма бяы тгм дуадийг амапаяастасг KAто паяоусиафы
	DCR E		      ; леиымы том летягтг тым епамакгьеым е
	MOV A,E
	CPI 00H             ; епамакалбамы левяи ма лгдемисеи о летягтгс
	JNZ LOOP1	      ; циа та 60 sec дгкадг

	MVI A,00H           ; лета та 60 sec пяепеи ма та сбгсы ока 
	CMA                 ; йамы тгм амтистяожг
 	STA 3000H	      ; елжамифы то апотекесла 00000000
	
	JMP WAIT            ; пеяилемеи тгм еполемг диайопг ле та калпайиа сбгста
END	